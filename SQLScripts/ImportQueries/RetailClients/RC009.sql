-- Query for RC009

SELECT DISTINCT
'RO' + t1.ClientCode AS ORGKEY
,'' AS COMMUNICATION_LANGUAGE
,'' AS PREFERRED_ADDRESS_MODE
,'' AS BEHAVIOURAL_SCORE
,'' AS RISK_BEHAVIOUR
,'' AS OTHER_BEHAVIOURAL_PROFILE
,'' AS LIFE_CYCLE_STAGE
,'' AS SERVICE_PERSONALISE
,'' AS PSYCHOGRAPHICTYPE
,'NA' AS PRIORITY_IDENTIFIER
,'' AS HOUSEHOLD_NUMBER
,'' AS PREFERRED_REP
,'' AS SEGMENTATION_CLASS
,(LEFT(t2.Name, CHARINDEX(' ', t2.Name))) AS PREFERREDNAME
,'' AS NUMBEROFDEPENDANTS
,'' AS NUMBEROFDEPENDANTCHILDREN
,'' AS STMTDATEFORCOMBSTMT
,'' AS SUBSEGMENT
,'NA' AS HOBBYFIELD1
,'NA' AS HOBBYFIELD2
,'NA' AS HOBBYFIELD3
,'NA' AS HOBBYFIELD4
,'NA' AS HOBBYFIELD5
,'NA' AS HOBBYFIELD6
,'NA' AS PROFILE_FIELD1
,'NA' AS PROFILE_FIELD2
,'NA' AS PROFILE_FIELD3
,'NA' AS PROFILE_FIELD4
,'NA' AS ALERT1
,'NA' AS ALERT2
,'NA' AS ALERT3
,'NA' AS ALERT4
,'NA' AS ALERT5
,'NA' AS FLAG1
,'NA' AS FLAG2
,'NA' AS FLAG3
,'NA' AS FLAG4
,'NA' AS FLAG5
,'NA' AS BANK_DEFINED_PREFER_VAR1
,'NA' AS BANK_DEFINED_PREFER_VAR2
,'NA' AS BANK_DEFINED_PREFER_VAR3
,'NA' AS BANK_DEFINED_PREFER_DATE1
,'NA' AS BANK_DEFINED_PREFER_DATE2
,'NA' AS BANK_DEFINED_PREFER_DATE3
,'NA' AS USERFIELD1
,'NA' AS USERFIELD2
,'NA' AS USERFIELD3
,'NA' AS USERFIELD4
,'NA' AS USERFIELD5
,'NA' AS USERFIELD6
,'NA' AS SPSERVICEREQUIRED1
,'NA' AS SPSERVICEREQUIRED2
,'NA' AS SPSERVICEREQUIRED3
,'NA' AS SPSERVICEREQUIRED4
,'NA' AS SPSERVICEREQUIRED5
,'NA' AS USERFLAG1
,'NA' AS USERFLAG2
,'NA' AS PREFRELSHIPDISCOUNT1
,'NA' AS PREFRELSHIPDISCOUNT2
,'NA' AS PREFRELSHIPDISCOUNTPERCENT1
,'NA' AS PREFRELSHIPDISCOUNTPERCENT2
,'NA' AS USERFIELD7
,'NA' AS USERFIELD8
,'NA' AS USERFIELD9
,'NA' AS USERFIELD10
,'NA' AS USERFIELD11
,'NA' AS USERFIELD12
,'NA' AS USERFIELD13
,'NA' AS AMOUNT1
,'NA' AS AMOUNT2
,'NA' AS AMOUNT3
,'NA' AS AMOUNT4
,'NA' AS AMOUNT5
,'NA' AS AMOUNT6
,'NA' AS AMOUNT7
,'NA' AS INTFIELD1
,'NA' AS INTFIELD2
,'NA' AS INTFIELD3
,'NA' AS INTFIELD4
,'NA' AS INTFIELD5
,'' AS STATEMENTTYPE
,'' AS STATEMENTFREQUENCY
,'' AS STMTDATEWEEKDAY
,'' AS STMTMONTHLYSTARTDATE
,'' AS ACTIONDURINGHOLIDAY
,'' AS DESPATCHMODE
,'' AS CALENDERTYPE
,'' AS DISCOUNTAVAILED
,'' AS DISCOUNTTYPE
,'NA' AS PREFEFFECTIVEDATE
,'NA' AS PREFEXPIRYDATE
,'NA' AS LASTCONTACTEDDATE
,'NA' AS LASTCONTACTEDCHANNEL
,'' AS FAMILYTYPE
,'' AS NOOFEARNERS
,'' AS REMARKS
,'' AS COMMUNITY
,'' AS LTVINDICATOR
,'' AS ASSETCLASSIFICATION
,'' AS ASSETCLASSIFICATIONDESC
,'NA' AS ASSETCLASSIFIEDON
,'' AS CUSTHEALTHCODE
,'' AS CREDITDISCOUNTPERCENT
,'' AS DEBITDISCOUNTPERCENT
,'NA' AS PREFERRENTIALEXPIRYDATE
,'' AS INTERESTDESCRIPTION
,'' AS STMTWEEKOFMONTH
,'' AS CUSTCHARGECODE
,'' AS CUSTCHARGE
,'' AS CHARGEDEBITFORACID
,'' AS CHARGEDEBITSOLID
,'Y' AS CHARGEHISTORYFLAG
,'' AS CUSTOMERCURRENCY
,'' AS LOANSSTATEMENTTYPE
,'' AS TDSSTATEMENTTYPE
,'' AS COMBSTMTCHARGECODE
,'' AS TDSCUSTFLOORLIMIT
,'' AS COMMUNITY_CODE
,'' AS CUST_HEALTH_REF_CODE
,'NA' AS CUST_PREF_TILL_DATE
,'' AS CU_TDSCUSTFLOORLIMIT
,'' AS CHECKSUM
,'en_US' AS PREFERRED_LOCALE
,'SNMANPKA' AS BANK_ID
,'' AS EXT_SYS_PRICING
,'' AS PRICING_EFFECTIVE_DATE
,'' AS PRICING_REVIEW_DATE
,'' AS RELATIONSHIP_PRICING_ID
FROM Master t1 JOIN ClientTable t2 ON t1.ClientCode = t2.ClientCode
WHERE t1.IsBlocked NOT IN ('C','o')  -- Filters the closed or invalid or unapproved accounts
AND EXISTS
(
	SELECT 1 FROM AcCustType WHERE MainCode = t1.MainCode and CustTypeCode = 'Z' and CustType IN ('11','12')
)
ORDER BY ORGKEY;