-- Query for OBGUPL

SELECT
'A' AS OBGUPL_001
,gm.MainCode AS OBGUPL_002    -- Need to confirm whether BranchCode or MainCode
,gm.ReferenceNo AS OBGUPL_003
,RIGHT(SPACE(17)+CAST(gm.BaseAmount AS VARCHAR(17)),17) AS OBGUPL_004
,'' AS OBGUPL_005
,DATEPART(DAY,gm.ExpiryDate) AS OBGUPL_006  
,gm.ExpiryDate AS OBGUPL_007
,'' AS OBGUPL_008
,'' AS OBGUPL_009
,CONVERT(VARCHAR(10),gm.ExpiryDate,105) AS OBGUPL_010
,'A' AS OBGUPL_011
,CASE WHEN m.AcType IN ('92','9B') THEN 'BBG'
	WHEN m.AcType IN ('93','9C') THEN 'PB'
	WHEN m.AcType IN ('94','9D') THEN 'APG'
	WHEN m.AcType = '95' THEN 'OTHER'
 END AS OBGUPL_012
,gm.CyCodeGt AS OBGUPL_013
,m.ClientCode AS OBGUPL_014
,CONVERT(VARCHAR(10),gm.IssueDate,105)  AS OBGUPL_015
,LEFT(gm.Purpose1,39) AS OBGUPL_016
,CASE WHEN m.AcType IN ('92','9B') THEN 'BBG'
	WHEN m.AcType IN ('93','9C') THEN 'PB'
	WHEN m.AcType IN ('94','9D') THEN 'APG'
	WHEN m.AcType = '95' THEN 'OTHER'
 END AS OBGUPL_017
,CONVERT(VARCHAR(10),gm.IssueDate,105) AS OBGUPL_018
,'NONE' AS OBGUPL_019
,'NONE' AS OBGUPL_020
,'' AS OBGUPL_021   -- Need to confirm as highlighted in red in mapping sheet
,'' AS OBGUPL_022
,gm.Remarks AS OBGUPL_023
,gm.ContraAc AS OBGUPL_024
,'' AS OBGUPL_025
,'' AS OBGUPL_026
,'' AS OBGUPL_027
,'' AS OBGUPL_028
,'' AS OBGUPL_029
,'' AS OBGUPL_030
,'' AS OBGUPL_031
,gm.Nominee AS OBGUPL_032
,ct.Name AS OBGUPL_033
,ct.Address1 AS OBGUPL_034
,ct.Address2 AS OBGUPL_035
,ct.Address3 AS OBGUPL_036
,ct.City AS OBGUPL_037   -- Size is more than required (actual 25 needed 5)
,'' AS OBGUPL_038
,ct.CountryCode AS OBGUPL_039  -- Need to be confirmed
,'' AS OBGUPL_040
,'' AS OBGUPL_041
,CASE WHEN td.CyCode <> '001' THEN gm.CyCodeGt
	ELSE ''
 END AS OBGUPL_042
,gm.CyRate AS OBGUPL_043
,LEFT(td.Desc1,16) AS OBGUPL_044
,'' AS OBGUPL_045
,'' AS OBGUPL_046
,gm.Beneficiary1 AS OBGUPL_047
,LEFT(gm.Beneficiary2,40) AS OBGUPL_048
,LEFT(gm.Beneficiary3,40) AS OBGUPL_049
,'' AS OBGUPL_050
,'' AS OBGUPL_051
,'' AS OBGUPL_052
,'' AS OBGUPL_053
,'' AS OBGUPL_054
,'' AS OBGUPL_055
,'' AS OBGUPL_056
,'' AS OBGUPL_057
,'' AS OBGUPL_058
,'' AS OBGUPL_059
,'' AS OBGUPL_060
,'' AS OBGUPL_061
,'' AS OBGUPL_062
,'' AS OBGUPL_063
,'' AS OBGUPL_064
,'' AS OBGUPL_065
,'' AS OBGUPL_066
,'' AS OBGUPL_067
,'' AS OBGUPL_068
,ctbl.CyDesc AS OBGUPL_069
,'' AS OBGUPL_070
,'' AS OBGUPL_071
,'' AS OBGUPL_072
,'' AS OBGUPL_073
,'' AS OBGUPL_074
,'' AS OBGUPL_075
,'' AS OBGUPL_076
,'' AS OBGUPL_077
,'' AS OBGUPL_078
,'' AS OBGUPL_079
,'' AS OBGUPL_080
,'' AS OBGUPL_081
,'' AS OBGUPL_082
,'' AS OBGUPL_083
,'' AS OBGUPL_084
,'' AS OBGUPL_085
,'' AS OBGUPL_086
,'' AS OBGUPL_087
,'' AS OBGUPL_088
,'' AS OBGUPL_089
,'' AS OBGUPL_090
,'' AS OBGUPL_091
,'' AS OBGUPL_092
,'' AS OBGUPL_093
,'' AS OBGUPL_094
,'' AS OBGUPL_095
,'' AS OBGUPL_096
,'' AS OBGUPL_097
,'' AS OBGUPL_098
,'' AS OBGUPL_099
,'' AS OBGUPL_100
,'' AS OBGUPL_101
,'' AS OBGUPL_102
,'' AS OBGUPL_103
,'' AS OBGUPL_104
,'' AS OBGUPL_105
,'' AS OBGUPL_106
,'' AS OBGUPL_107
,'' AS OBGUPL_108
,'' AS OBGUPL_109
,'' AS OBGUPL_110
,'' AS OBGUPL_111
,'' AS OBGUPL_112
,'' AS OBGUPL_113
,'' AS OBGUPL_114
,'' AS OBGUPL_115
,'' AS OBGUPL_116
,'' AS OBGUPL_117
,'' AS OBGUPL_118
,'' AS OBGUPL_119
,'' AS OBGUPL_120
,'' AS OBGUPL_121
,'' AS OBGUPL_122
,'' AS OBGUPL_123
,'' AS OBGUPL_124
,'' AS OBGUPL_125
,'' AS OBGUPL_126
,'' AS OBGUPL_127
,'' AS OBGUPL_128
,'' AS OBGUPL_129
,'' AS OBGUPL_130
,'' AS OBGUPL_131
,'' AS OBGUPL_132
,'' AS OBGUPL_133
,'' AS OBGUPL_134
,'' AS OBGUPL_135
,'' AS OBGUPL_136
,'' AS OBGUPL_137
,'' AS OBGUPL_138
,'' AS OBGUPL_139
,'' AS OBGUPL_140
,'' AS OBGUPL_141
,'' AS OBGUPL_142
,'' AS OBGUPL_143
,'' AS OBGUPL_144
,'' AS OBGUPL_145
,'' AS OBGUPL_146
,'' AS OBGUPL_147
,'' AS OBGUPL_148
,'' AS OBGUPL_149
,'' AS OBGUPL_150
,'' AS OBGUPL_151
,'' AS OBGUPL_152
,'' AS OBGUPL_153
,'' AS OBGUPL_154
,'' AS OBGUPL_155
,'' AS OBGUPL_156
,'' AS OBGUPL_157
,'' AS OBGUPL_158
,'' AS OBGUPL_159
,'' AS OBGUPL_160
,'' AS OBGUPL_161
,'' AS OBGUPL_162
,'' AS OBGUPL_163
,'' AS OBGUPL_164
,'' AS OBGUPL_165
,'' AS OBGUPL_166
,'' AS OBGUPL_167
,'' AS OBGUPL_168
FROM GtMaster gm
LEFT JOIN Master m ON gm.MainCode = m.MainCode AND gm.BranchCode = m.BranchCode
LEFT JOIN ClientTable ct ON m.ClientCode = ct.ClientCode
LEFT JOIN TransDetail td ON gm.MainCode = td.MainCode AND gm.BranchCode = td.BranchCode
LEFT JOIN CurrencyTable ctbl ON gm.CyCodeGt = ctbl.CyCode