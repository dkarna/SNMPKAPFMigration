-- Query for RC003

SELECT DISTINCT
'RO' + t1.ClientCode AS ORGKEY
,'RO' + t1.ClientCode AS CIFID
,'' AS STRTEXT2
,'' AS STRTEXT1
,'CURRENCY' AS TYPE
,'NPR' AS CUSTOMERCURRENCY
,'' AS CREDITDISCOUNTPERCENT
,'' AS DEBITDISCOUNTPERCENT
,'NA' AS WITHHOLDTAXPCNT
,'NA' AS WITHHOLDTAXFLOORLMT
,'30-12-2099' AS DTDATE1
,'' AS DTDATE2
,'NEPAL' AS COUNTRYOFISSUE_CODE
,'NA' AS SMALL_STR1
,'NA' AS SMALL_STR2
,'NA' AS SMALL_STR3
,'NA' AS SMALL_STR4
,'NA' AS SMALL_STR5
,'NA' AS SMALL_STR6
,'NA' AS SMALL_STR7
,'NA' AS SMALL_STR8
,'NA' AS SMALL_STR9
,'NA' AS SMALL_STR10
,'NA' AS MED_STR1
,'NA' AS MED_STR2
,'NA' AS MED_STR3
,'NA' AS MED_STR4
,'NA' AS MED_STR5
,'NA' AS MED_STR6
,'NA' AS MED_STR7
,'NA' AS MED_STR8
,'NA' AS MED_STR9
,'NA' AS MED_STR10
,'NA' AS LARGE_STR1
,'NA' AS LARGE_STR2
,'NA' AS LARGE_STR3
,'NA' AS LARGE_STR4
,'NA' AS LARGE_STR5
,'NA' AS DATE1
,'NA' AS DATE2
,'NA' AS DATE3
,'NA' AS DATE4
,'NA' AS DATE5
,'NA' AS DATE6
,'NA' AS DATE7
,'NA' AS DATE8
,'NA' AS DATE9
,'NA' AS DATE10
,'NA' AS NUMBER1
,'NA' AS NUMBER2
,'NA' AS NUMBER3
,'NA' AS NUMBER4
,'NA' AS NUMBER5
,'NA' AS NUMBER6
,'NA' AS NUMBER7
,'NA' AS NUMBER8
,'NA' AS NUMBER9
,'NA' AS NUMBER10
,'NA' AS DECIMAL1
,'NA' AS DECIMAL2
,'NA' AS DECIMAL3
,'NA' AS DECIMAL4
,'NA' AS DECIMAL5
,'NA' AS DECIMAL6
,'NA' AS DECIMAL7
,'NA' AS DECIMAL8
,'NA' AS DECIMAL9
,'NA' AS DECIMAL10
,'' AS STRTEXT3
,'' AS STRTEXT4
,'' AS STRTEXT5
,'' AS STRTEXT6
,'' AS STRTEXT7
,'' AS STRTEXT8
,'' AS STRTEXT9
,'NPR' AS STRTEXT10
,'NA' AS INTINTEGER1
,'NA' AS INTINTEGER2
,'NA' AS INTINTEGER3
,'NA' AS INTINTEGER4
,'NA' AS INTINTEGER5
,'NA' AS INTINTEGER6
,'NA' AS INTINTEGER7
,'NA' AS INTINTEGER8
,'NA' AS INTINTEGER9
,'NA' AS INTINTEGER10
,'NA' AS INTINTEGER11
,'NA' AS INTINTEGER12
,'NA' AS INTINTEGER13
,'NA' AS INTINTEGER14
,'NA' AS INTINTEGER15
,'NA' AS DTDATE3
,'' AS DTDATE4
,'NA' AS DTDATE5
,'' AS DBFLOAT1
,'' AS DBFLOAT2
,'' AS DBFLOAT3
,'' AS DBFLOAT4
,'NA' AS DBFLOAT5
,'NA' AS STRTEXT11
,'NA' AS STRTEXT12
,'NA' AS STRTEXT13
,'NA' AS STRTEXT14
,'' AS STRTEXT15
,'' AS STRTEXT16
,'' AS STRTEXT17
,'' AS STRTEXT18
,'' AS STRTEXT19
,'' AS STRTEXT20
,'' AS STRTEXT21
,'DEF_VALUE' AS STRTEXT22
,'' AS STRTEXT23
,'' AS STRTEXT24
,'' AS STRTEXT25
,'' AS STRTEXT26
,'NA' AS STRTEXT27
,'' AS EMPLOYERID
,t2.ClientTag2 AS EMPLOYEEID
,'NA' AS STRTEXT1_CODE
,'' AS STRTEXT2_CODE
,'NA' AS STRTEXT28
,'SNMANPKA' AS BANK_ID   -- Added by Deepak
FROM Master t1 JOIN ClientTable t2 ON t1.ClientCode = t2.ClientCode
WHERE t1.IsBlocked NOT IN ('C','o')  -- Filters the closed or invalid or unapproved accounts
AND EXISTS
(
	SELECT 1 FROM AcCustType WHERE MainCode = t1.MainCode and CustTypeCode = 'Z' and CustType IN ('11','12')
)